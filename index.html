<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Shodan Parser</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Purple Strike logo -->
  <a href="#" class="ps-logo-wrap" aria-label="Purple Strike">
    <img src="purple_strike_logo_transparent.png" alt="Purple Strike logo" class="ps-logo">
  </a>

  <!-- Header -->
  <header>
    <h1>Shodan Parser</h1>
    <p class="subtitle">
      Convert messy Shodan JSON into clean, structured CSV.<br/>
      Quickly filter, search (preview), and export insights (CSV/XLSX).
    </p>
  </header>

  <!-- Messages -->
  <section id="messages" aria-live="polite"></section>

  <!-- Progress bar -->
<div id="progressWrap" class="progress" style="display:none">
  <div id="progressBar" class="progress__bar" style="width:0%"></div>
  <!-- Either of these is fine -->
  <div id="progressLabel" class="progress__text">0%</div>
  <!-- or -->
  <!-- <div id="progressText"  class="progress__text">0%</div> -->
</div>


  <!-- Toolbar -->
  <div class="toolbar">
    <button id="btnBeautify" type="button">Beautify JSON</button>
    <button id="btnValidate" type="button">Validate JSON</button>
    <button id="btnUpload"   type="button">Upload JSON</button>

    <!-- IMPORTANT: these ids are used by the script logic -->
    <button id="btnSearch"   type="button">Search (Preview Only)</button>
    <button id="btnClear"    type="button">Clear</button>
    <button id="btnExtract"  type="button">Extract & Download</button>

    <input type="file" id="fileInput" accept=".json" style="display:none" />
    <a id="downloadLink" style="display:none">Download CSV</a>
    <a id="excelLink" style="display:none">Download XLSX (merged)</a>
  </div>

  <!-- Field Selector -->
  <div class="field-selector">
    <strong>Quick Fields:</strong>
    <label><input type="checkbox" id="field_ip" checked> IP</label>
    <label><input type="checkbox" id="field_domain" checked> Domain(s)</label>
    <label><input type="checkbox" id="field_ports" checked> Ports</label>
    <label><input type="checkbox" id="field_city" checked> City</label>
    <label><input type="checkbox" id="field_org" checked> Organization</label>
    <label><input type="checkbox" id="field_vulns" checked> Vulnerabilities</label>
    <label><input type="checkbox" id="field_webtech" checked> Products</label>
    <label><input type="checkbox" id="field_versions" checked> Versions</label>
  </div>

  <!-- Filters -->
  <section class="advanced">
    <div class="advanced__row">
      <div class="advanced__col">
        <h3>Filters</h3>
        <p class="muted">Include rows containing ALL of these terms (case-insensitive):</p>
        <input id="includeFilter" class="textline" placeholder="e.g., 443; nginx; ssl" />
        <p class="muted">Exclude rows containing ANY of these terms:</p>
        <input id="excludeFilter" class="textline" placeholder="e.g., telnet; ftp" />
        <div class="tiny muted">Terms are split by <code>;</code>. Filtering is applied to each CSV row string.</div>
      </div>
    </div>
  </section>

  <!-- Editors -->
  <main class="editor">
    <textarea id="beautifyInput" placeholder="Paste Shodan JSON here..."></textarea>
    <textarea id="beautifyOutput" placeholder="Beautified/validation output..." readonly></textarea>
  </main>

  <!-- Summary -->
  <section id="miniSummary" style="display:none; padding:0.6rem 1rem;">
    <div class="summary-grid">
      <div class="pill">IP: <span id="sum_ip">0</span></div>
      <div class="pill">Domain(s): <span id="sum_domains">0</span></div>
      <div class="pill">Ports: <span id="sum_ports">0</span></div>
      <div class="pill">City: <span id="sum_cities">0</span></div>
      <div class="pill">Organization: <span id="sum_orgs">0</span></div>
      <div class="pill">Vulnerabilities: <span id="sum_vulns">0</span></div>
      <div class="pill">Products: <span id="sum_products">0</span></div>
      <div class="pill">Versions: <span id="sum_versions">0</span></div>
      <div class="pill">Web Tech: <span id="sum_webtech">0</span></div>
    </div>
  </section>

  <!-- Preview -->
  <section id="csvPreviewSection" style="display:none; padding: 1rem;">
    <h2>Preview</h2>
    <div id="csvPreview"></div>
  </section>

  <!-- Error details -->
  <details id="errorDetails" class="error-details" style="display:none;">
    <summary>Parser error details</summary>
    <pre id="errorDump"></pre>
  </details>

  <script src="script.js"></script>
</body>
</html>
